function getImgId(e){var t=e.substring(e.lastIndexOf("/")+1,e.length);return t}function NavController(e){e.selectedNav=0,e.navItems=[{href:"#todayList",title:"Latest"},{href:"#addShow",title:"Add Shows"},{href:"#showList",title:"All Shows"}],e.changeView=function(t){e.selectedNav=t,1==e.selectedNav}}function SearchShowsController(e,t){e.epi=!0,e.img=!0,e.msg="",e.class="message",e.shows=[],e.isShown=!1,e.getShows=function(){e.shows=[],""==e.searchName?(e.msg="Enter a show to search for.",e.class="error",e.shows=[],e.isShown=!1):(e.msg="Searching for "+e.searchName,e.class="message",t({method:"GET",url:u.search+e.searchName}).success(function(t){e.msg="",e.isShown=!0,e.shows=t}).error(function(){e.msg="There was an error. Try again.",e.class="error",e.isShown=!1,e.shows=[]}))},e.saveShow=function(s){var o=e.shows[s];if(o.showid=o.tvdb_id,delete o.tvdb_id,tv.indexedDB.addShow(o),e.epi!==!1&&(t({method:"GET",url:urls.proxy+urls.api+urls.id+"/series/"+o.showid+"/all/en.xml"}).success(function(e){$.console({message:"Episode details downloaded."});var t={};$(e).find("Series").each(function(){t.showid=$(this).find("id").text(),t.poster=$(this).find("poster").text(),t.name=$(this).find("SeriesName").text()});var s=[];$(e).find("Episode").each(function(){var e={};e.name=$(this).find("EpisodeName").text(),e.showname=t.name,e.showid=$(this).find("seriesid").text(),e.episodeID=$(this).find("id").text(),e.overview=$(this).find("Overview").text(),e.guestStars=$(this).find("GuestStars").text(),e.airdate=$(this).find("FirstAired").text(),e.season=$(this).find("SeasonNumber").text(),e.episode=$(this).find("EpisodeNumber").text(),e.lastUpdated=$(this).find("lastupdated").text(),s.push(e)}),tv.indexedDB.addEpisodes(s,t)}).error(function(){e.msg="There was an error while downloading episode list.",e.class="error"}),e.img!==!1)){var n=urls.proxy+u.poster+getImgId(o.images.poster);tv.network.getPoster(o.showid,n)}}}function UpcomingController(e){e.shows=[],e.info="Loading shows...",e.noUpcoming=!0,e.noUpcoming=e.shows.length>0?!1:!0,e.formatDate=function(e){return tv.ui.formatDate(e)},e.dayType=function(e){var t=tv.ui.getDate(0);return t>e?"yesterday":e==t?"today":e>t?"yet-to-come":void 0}}function ShowListController(e){e.shows=[],e.info="Loading shows...",e.noAdded=!0,e.deletedIndex=null,e.noAdded=e.shows.length>0?!1:!0,e.status=function(e){return e?"Ended":"Continuing"},e.deleteShow=function(t){$.confirm({message:"Do you want to delete "+e.shows[t].data.title+" ?",okText:"Yes",cancelText:"No",onconfirm:function(){tv.indexedDB.deleteShowComplete(e.shows[t].data.showid)}})},e.showInfo=function(t){var s=angular.element($("body")).scope();s.changeView(3);var o=angular.element($("#showInfo")).scope();o.show=e.shows[t]}}function ShowInfoController(e){e.show={},e.getBack=function(){var e=angular.element($("body")).scope();e.changeView(2)},e.status=function(e){return e?"Ended":"Continuing"}}!function(e){e(window).load(function(){e("a").on("click",function(){return!1}),e("#content").slimscroll({height:"475px",railVisible:!0}),tv.indexedDB.open()})}(jQuery);